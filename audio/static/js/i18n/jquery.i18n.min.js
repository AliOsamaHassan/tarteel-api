/*!
 * jQuery Internationalization library
 *
 * Copyright (C) 2012 Santhosh Thottingal
 *
 * jquery.i18n is dual licensed GPLv2 or later and MIT. You don't have to do
 * anything special to choose one license or the other and you don't have to
 * notify anyone which license you are using. You are free to use
 * UniversalLanguageSelector in commercial projects as long as the copyright
 * header is left intact. See files GPL-LICENSE and MIT-LICENSE for details.
 *
 * @licence GNU General Public Licence 2.0 or later
 * @licence MIT License
 */
(function(c){var b,d=Array.prototype.slice;b=function(e){this.options=c.extend({},b.defaults,e);this.parser=this.options.parser;this.locale=this.options.locale;this.messageStore=this.options.messageStore;this.languages={}};b.prototype={localize:function(i){var g,h,f,k,e,j;f=this.locale;k=0;while(f){g=f.split("-");h=g.length;do{e=g.slice(0,h).join("-");j=this.messageStore.get(e,i);if(j){return j}h--}while(h);if(f==="en"){break}f=(c.i18n.fallbacks[this.locale]&&c.i18n.fallbacks[this.locale][k])||this.options.fallbackLocale;c.i18n.log("Trying fallback locale for "+this.locale+": "+f+" ("+i+")");k++}return""},destroy:function(){c.removeData(document,"i18n")},load:function(g,e){var j,h,f,i={};if(!g&&!e){g="i18n/"+c.i18n().locale+".json";e=c.i18n().locale}if(typeof g==="string"&&g.split("?")[0].split(".").pop()!=="json"){i[e]=g+"/"+e+".json";j=(c.i18n.fallbacks[e]||[]).concat(this.options.fallbackLocale);for(h=0;h<j.length;h++){f=j[h];i[f]=g+"/"+f+".json"}return this.load(i)}else{return this.messageStore.load(g,e)}},parse:function(e,g){var f=this.localize(e);this.parser.language=c.i18n.languages[c.i18n().locale]||c.i18n.languages["default"];if(f===""){f=e}return this.parser.parse(f,g)}};c.i18n=function(f,i){var g,h=c.data(document,"i18n"),e=typeof f==="object"&&f;if(e&&e.locale&&h&&h.locale!==e.locale){h.locale=e.locale}if(!h){h=new b(e);c.data(document,"i18n",h)}if(typeof f==="string"){if(i!==undefined){g=d.call(arguments,1)}else{g=[]}return h.parse(f,g)}else{return h}};c.fn.i18n=function(){var e=c.data(document,"i18n");if(!e){e=new b();c.data(document,"i18n",e)}return this.each(function(){var j=c(this),h=j.data("i18n"),k,i,g,f;if(h){k=h.indexOf("[");i=h.indexOf("]");if(k!==-1&&i!==-1&&k<i){g=h.slice(k+1,i);f=h.slice(i+1);if(g==="html"){j.html(e.parse(f))}else{j.attr(g,e.parse(f))}}else{j.html(e.parse(h))}}else{j.find("[data-i18n]").i18n()}})};function a(){var e=c("html").attr("lang");if(!e){e=navigator.language||navigator.userLanguage||""}return e}c.i18n.languages={};c.i18n.messageStore=c.i18n.messageStore||{};c.i18n.parser={parse:function(f,e){return f.replace(/\$(\d+)/g,function(i,h){var g=parseInt(h,10)-1;return e[g]!==undefined?e[g]:"$"+h})},emitter:{}};c.i18n.fallbacks={};c.i18n.debug=false;c.i18n.log=function(){if(window.console&&c.i18n.debug){window.console.log.apply(window.console,arguments)}};b.defaults={locale:a(),fallbackLocale:"en",parser:c.i18n.parser,messageStore:c.i18n.messageStore};c.i18n.constructor=b}(jQuery));